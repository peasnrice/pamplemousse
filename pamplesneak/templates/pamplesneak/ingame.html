{% extends "default_base.html" %}

{% load bootstrap3 %}
{% load dajaxice_templatetags %}
{% load static %}

{% block head %}
{% dajaxice_js_import %}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="{% static "dist/js/jquery.dajax.core.js" %}" type="text/javascript" charset="UTF-8">></script>

<script>
function refresh_words(word_bank_size){
  Dajaxice.pamplesneak.refresh_words(Dajax.process,{'word_bank_size':word_bank_size});
}

function refresh(word_bank_size){
  Dajaxice.pamplesneak.refreshWord(Dajax.process,{'game_id':{{ game.id }},'player_id':{{ player.id }}});
}

setInterval(function(){refresh()},10000);

$(function(){
  refresh();
});

function randomize_word(){
  Dajaxice.pamplesneak.randomizeWord(callback);
}

function callback(data){
  $("#id_word").val(data.random_word);
}

function word_succeed(){
  Dajaxice.pamplesneak.wordSuccess(Dajax.process,{'game_id':{{ game.id }},'player_id':{{ player.id }}});
}

function word_fail(){
  Dajaxice.pamplesneak.wordFail(Dajax.process,{'game_id':{{ game.id }},'player_id':{{ player.id }}});
}

</script>
{% endblock %}

{% block jumbotron %}
<div class="row">
  <div class="col-md-12">
    <div class="well well-sm">
      <div class="centered">
        <h1>Welcome to the Pamplesneak lobby!</h1>
        <p>Please wait here while we connect you with another player, or don't.</p>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block content %}
<div class="container">
  <div class="row">
    <div class="col-md-12">
      <div class="well">
        <div class="centered">
          {% include "pamplesneak/playerword.html" %}
          <p>I said my word and <button id="succeeded_button" class="btn btn-xs btn-warning" value="succeed" onclick="word_succeed();">
          Succeeded
        </button> <b>/</b>
         <button id="failed_button" class="btn btn-xs btn-warning" value="fail" onclick="word_fail();">
          Failed
        </button>
          </p>
        </div>
      </div>
    </div>
  </div>
  <div class="well">
    <div class="row">
      <div class="col-md-4 col-md-offset-3">
        <button id="random_word_button" class="btn btn-warning" value="Randomize Word" onclick="randomize_word();">
          Random Word
        </button>
        <button id="random_player_button" class="btn btn-warning" value="Randomize Player">
          Random Player
        </button>
        <form action="" method="POST">
          {% csrf_token %}
          {% bootstrap_form form %} 
          {% buttons %}
            <button type="submit" class="btn btn-warning" value="Send Word">
              Send Word
            </button>
          {% endbuttons %}
        </form>
      </div>
      <div class="col-md-4">

      </div>
    </div>
  </div>
{% endblock %}